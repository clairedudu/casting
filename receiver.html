<!doctype html>
<html>
  <body>
    <div>
      Test casting!
    </div>
    <div id = "text1"> </div>
    <div id = "text2"> </div>
    <div id = "text3"> </div>
    <div id='report-image' style='background: #000;
                display: block;
                height: 100vh;
                object-fit: contain;
                position: fixed;
                width: 100vw;'>
    </div>
    <img id='test' style='position:fixed; top:30px;'>
  </body>
  
<script>
  var dataUrl;
  var img = document.getElementById("report-image");
 img.src = "https://i.ytimg.com/vi/icqDxNab3Do/maxresdefault.jpg";
  
  if (navigator.presentation.receiver) {
    navigator.presentation.receiver.connectionList.then(list => {
      list.connections.map(connection => {
        addConnection(connection);
      });
      list.onconnectionavailable = (evt) => {
        addConnection(evt.connection);
      };
    });
  }
   function addConnection(connection) {
  //   document.getElementById("text1").innerHTML = "connected to: " + connection.id;
     connection.onmessage = (message) => {
       document.getElementById("text2").innerHTML = "message received!";
       //document.getElementById("text3").innerHTML = "message.data: " + message.data;
       var svg = new Blob([message.data], {type: 'image/svg+xml'});
       console.log("svg: " + svg);
       var DOMURL = window.URL || window.webkitURL || window;
       var url = DOMURL.createObjectURL(svg);
       
       img.src = url;
     };
   }
</script>
  
</html>

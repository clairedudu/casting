<!doctype html>
<html>
  <body>
    <!--
    <div>
      Test casting!
    </div>
    <div id = "text1"> </div>
    <div id = "text2"> </div>
    <div id = "text3"> </div>
-->
    <div style='background: #000;
                display: block;
                height: 100vh;
                object-fit: contain;
                width: 100vw;'>
      <div id='report-image' style='position: absolute;'> </div>
    </div>
  </body>
  
<script>
  var dataUrl;
  var img = document.getElementById("report-image");
  
  if (navigator.presentation.receiver) {
    navigator.presentation.receiver.connectionList.then(list => {
      list.connections.map(connection => {
        addConnection(connection);
      });
      list.onconnectionavailable = (evt) => {
        addConnection(evt.connection);
      };
    });
  }
   function addConnection(connection) {
  //   document.getElementById("text1").innerHTML = "connected to: " + connection.id;
     connection.onmessage = (message) => {
      // document.getElementById("text2").innerHTML = "message received!";
       //document.getElementById("text3").innerHTML = "message.data: " + message.data;
       var svg = message.data;
       var bBox = svg.getBBox();
       console.log("width " + bBox.width);
       console.log("height " + bBox.height);
       console.log("viewbox " + '0 0 ' + bBox.width + ' ' + bBox.height + "'");
       svg.setAttribute('viewBox', '0 0 ' + bBox.width + ' ' + bBox.height + "'");
       img.outerHTML += svg;
     };
   }
</script>
  
</html>

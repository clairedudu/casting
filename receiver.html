<!doctype html>
<html>
  <body>
    <div>
      Test casting!!
    </div>
    <div id = "text1"> </div>
    <div id = "text2"> </div>
    <div style='position:fixed; height:100%; width:100%; top:0;'>
      <img id='report-image' style='height:100%;'>
    </div>
  </body>
  
<script>
  
  if (true) {
    navigator.presentation.receiver.connectionList.then(list => {
      list.connections.map(connection => {
        addConnection(connection);
      });
      list.onconnectionavailable = (evt) => {
        addConnection(evt.connection);
      };
    });
  }
   function addConnection(connection) {
     document.getElementById("text1").innerHTML = "connected to: " + connection.id;
     var image = document.getElementById("report-image");
     connection.onmessage = (message) => {
       document.getElementById("text2").innerHTML = "message received!";
       image.src = message.data;
     };
   }
</script>
  
</html>
